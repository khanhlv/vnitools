<!doctype html>
<html lang="en">
 <head> 
  <link rel="dns-prefetch" href="http://fonts.gstatic.com/"> 
  <link rel="dns-prefetch" href="/assets/"> 
  <meta charset="utf-8"> 
  <meta name="viewport" content="width=device-width, initial-scale=1"> 
  <link rel="stylesheet" type="text/css" href="../lib/rapid02.css"> 
  <link rel="apple-touch-icon" sizes="180x180" href="../lib/favicon/apple-touch-icon.png"> 
  <link rel="icon" type="image/png" href="../lib/favicon/favicon-32x32.png" sizes="32x32"> 
  <link rel="icon" type="image/png" href="../lib/favicon/favicon-16x16.png" sizes="16x16"> 
  <link rel="manifest" href="../lib/favicon/manifest.json"> 
  <link rel="mask-icon" href="../lib/favicon/safari-pinned-tab.svg" color="#5bbad5"> 
  <link rel="shortcut icon" href="../lib/favicon/favicon.ico"> 
  <meta name="msapplication-config" content="/lib/favicon/browserconfig.xml"> 
  <meta name="theme-color" content="#ffffff"> 
  <meta name="format-detection" content="telephone=no"> 
  <title>Online chart bar a create | maker graph bar</title> 
  <meta content="Bar graph. Column chart maker online ðŸ“Š." name="description"> 
  <link rel="stylesheet" href="/assets/npm/bootstrap4.5.3/dist/css/bootstrap.min.css"> 
  <style>
   #wrapper { height:auto !important; }
   h1 { font-size:1.6rem; }
   h2 { font-size:1.4rem; }
   h3 { font-size:1.4rem; }
   h4 { font-size:1.2rem; }
   #gen { background:#eee8d5; padding:20px; max-width:650px; }
   #gen .input-group-append input[type=text] { width:100px; }
   #gen input[type=color] { width:70px; }
	.nav-link i { vertical-align:middle; }
	.btn-group i { vertical-align:middle; }
   .btn-group a { color:#fff; }
   #chart_div { overflow-x:auto; }
	@media only screen and  (max-width:600px) {
      #doc { padding-right:0; }
      #gen { padding:10px; }
      .btn-group button:nth-child(4) { display:none; }
      #fsbtn { display:none; }
	}
	@media only screen and  (min-width:601px) {
      #lcol { width:670px; }
   }
</style> 
  <!-- Google tag (gtag.js) --> 
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-LKG5DF2S9J"></script> 
  <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-LKG5DF2S9J');
</script> 
 </head> 
 <body> 
  <div id="header"> 
   <div> 
    <div id="logo"> 
     <a href="../index.html">Calculators &amp; Tools</a> 
    </div> 
    <div class="gcse-search"></div> 
   </div> 
  </div> 
  <div id="wrapper"> 
   <div id="nav"> 
    <a href="../index.html">Home</a>â€º 
    <a href="index.html">Tools</a>â€º 
    <a href="bar-graph.html">Bar graph maker</a> 
   </div> 
   <div id="lcol"> 
    <div id="doc"> 
     <h1>Bar Graph Maker</h1> 
     <form id="gen" name="gen"> 
      <ul class="nav nav-tabs"> 
       <li class="nav-item"> <a class="nav-link" href="line-graph.html"><img src="../lib/icons/material/svg/show_chart_black_24dp.svg" loading="lazy" width="24" height="24" alt=""> Line Graph</a> </li> 
       <li class="nav-item"> <a class="nav-link active" href="#"><img src="../lib/icons/material/svg/bar_chart_black_24dp.svg" loading="lazy" width="24" height="24" alt=""> Bar Graph</a> </li> 
       <li class="nav-item"> <a class="nav-link" href="pie-chart.html"><img src="../lib/icons/material/svg/pie_chart_black_24dp.svg" loading="lazy" width="24" height="24" alt=""> Pie Chart</a> </li> 
       <li class="nav-item"> <a class="nav-link" href="scatter-plot.html"><img src="../lib/icons/material/svg/scatter_plot_black_24dp.svg" loading="lazy" width="24" height="24" alt=""> XY Scatter Plot</a> </li> 
       <li class="nav-item"> <a class="nav-link" href="table-chart.html"><img src="../lib/icons/material/svg/table_chart_black_24dp.svg" loading="lazy" width="24" height="24" alt=""> Table Chart</a> </li> 
      </ul> 
      <br> 
      <div class="form-group row"> 
       <label for="title" class="col-sm-3 col-form-label">Graph title</label> 
       <div class="col-sm-9"> 
        <input type="text" id="title" name="title" placeholder="Graph Title" autocomplete="off" class="form-control"> 
       </div> 
      </div> 
      <div class="form-group row"> 
       <label for="hlabel" class="col-sm-3 col-form-label">Horizontal axis</label> 
       <div class="input-group col-sm-9"> 
        <input type="text" id="hlabel" name="hlabel" placeholder="hLabel" class="form-control"> 
        <input type="text" id="hmin" name="hmin" placeholder="min" class="form-control col-sm-2"> 
        <input type="text" id="hmax" name="hmax" placeholder="max" class="form-control col-sm-2"> 
        <select id="hformat" class="form-control"> <option>Decimal</option> <option>Scientific</option> <option>Currency</option> <option>Percent</option> <option>Short</option> <option>Long</option> </select> 
        <select id="hscale" class="form-control"> <option>Linear</option> <option>Log</option> <option>mirrorLog</option> </select> 
       </div> 
      </div> 
      <div class="form-group row"> 
       <label for="vlabel" class="col-sm-3 col-form-label">Vertical axis</label> 
       <div class="input-group col-sm-9"> 
        <input type="text" id="vlabel" name="vlabel" placeholder="vLabel" class="form-control"> 
        <input type="text" id="vmin" name="vmin" placeholder="min" class="form-control col-sm-2"> 
        <input type="text" id="vmax" name="vmax" placeholder="max" class="form-control col-sm-2"> 
        <select id="vformat" class="form-control"> <option>Decimal</option> <option>Scientific</option> <option>Currency</option> <option>Percent</option> <option>Short</option> <option>Long</option> </select> 
        <select id="vscale" class="form-control"> <option>Linear</option> <option>Log</option> <option>mirrorLog</option> </select> 
       </div> 
      </div> 
      <div class="form-group row"> 
       <label for="type" class="col-sm-3 col-form-label">Horiz. data type</label> 
       <div class="col-sm-9"> 
        <select id="type" name="type" onchange="OnTypeChange()" class="form-control"> <option>Data labels</option> <option>Data values</option> <option>Data range</option> </select> 
       </div> 
      </div> 
      <div id="xrow0" class="form-group row"> 
       <label for="vlabel" class="col-sm-3 col-form-label">Data labels</label> 
       <div class="col-sm-9"> 
        <input type="text" id="xdesc" name="xdesc" placeholder="name_1 name_2 name_3 name_4 ..." class="form-control"> 
       </div> 
      </div> 
      <div id="xrow1" style="display:none" class="form-group row"> 
       <label for="xdata" class="col-sm-3 col-form-label">Data values</label> 
       <div class="col-sm-9"> 
        <input type="text" id="xdata" name="xdata" placeholder="1 2 3 4 ..." class="form-control"> 
       </div> 
      </div> 
      <div id="xrow2" style="display:none" class="form-group row"> 
       <label for="xrange" class="col-sm-3 col-form-label">Data range</label> 
       <div class="col-sm-9"> 
        <input type="text" id="xrange" name="xrange" placeholder="1 4" class="form-control"> 
       </div> 
      </div> 
      <hr> 
      <div class="form-group row"> 
       <label for="num" class="col-sm-3 col-form-label">Number of lines</label> 
       <div class="col-sm-9"> 
        <select id="num" name="num" onchange="OnLineNumChange()" class="form-control"> <option selected>1 bar</option> <option>2 bars</option> <option>3 bars</option> <option>4 bars</option> <option>5 bars</option> <option>6 bars</option> <option>7 bars</option> </select> 
       </div> 
      </div> 
      <div class="form-group row datarow"> 
       <label class="col-sm-3 col-form-label">Bar1 data values</label> 
       <div class="input-group col-sm-9"> 
        <input type="text" name="data[]" placeholder="300 500 100 200 ..." class="form-control"> 
        <div class="input-group-append"> 
         <input type="text" name="desc[]" placeholder="Bar1" class="form-control"> 
         <input type="color" name="color[]" value="#3366CC" class="form-control"> 
        </div> 
       </div> 
      </div> 
      <div class="form-group row datarow" style="display:none"> 
       <label class="col-sm-3 col-form-label">Bar2 data values</label> 
       <div class="input-group col-sm-9"> 
        <input type="text" name="data[]" placeholder="300 500 100 200 ..." class="form-control"> 
        <div class="input-group-append"> 
         <input type="text" name="desc[]" placeholder="Bar2" class="form-control"> 
         <input type="color" name="color[]" value="#DC3912" class="form-control"> 
        </div> 
       </div> 
      </div> 
      <div class="form-group row datarow" style="display:none"> 
       <label class="col-sm-3 col-form-label">Bar3 data values</label> 
       <div class="input-group col-sm-9"> 
        <input type="text" name="data[]" placeholder="300 500 100 200 ..." class="form-control"> 
        <div class="input-group-append"> 
         <input type="text" name="desc[]" placeholder="Bar3" class="form-control"> 
         <input type="color" name="color[]" value="#FF9900" class="form-control"> 
        </div> 
       </div> 
      </div> 
      <div class="form-group row datarow" style="display:none"> 
       <label class="col-sm-3 col-form-label">Bar4 data values</label> 
       <div class="input-group col-sm-9"> 
        <input type="text" name="data[]" placeholder="300 500 100 200 ..." class="form-control"> 
        <div class="input-group-append"> 
         <input type="text" name="desc[]" placeholder="Bar4" class="form-control"> 
         <input type="color" name="color[]" value="#109618" class="form-control"> 
        </div> 
       </div> 
      </div> 
      <div class="form-group row datarow" style="display:none"> 
       <label class="col-sm-3 col-form-label">Bar5 data values</label> 
       <div class="input-group col-sm-9"> 
        <input type="text" name="data[]" placeholder="300 500 100 200 ..." class="form-control"> 
        <div class="input-group-append"> 
         <input type="text" name="desc[]" placeholder="Bar5" class="form-control"> 
         <input type="color" name="color[]" value="#990099" class="form-control"> 
        </div> 
       </div> 
      </div> 
      <div class="form-group row datarow" style="display:none"> 
       <label class="col-sm-3 col-form-label">Bar6 data values</label> 
       <div class="input-group col-sm-9"> 
        <input type="text" name="data[]" placeholder="300 500 100 200 ..." class="form-control"> 
        <div class="input-group-append"> 
         <input type="text" name="desc[]" placeholder="Bar6" class="form-control"> 
         <input type="color" name="color[]" value="#0099C6" class="form-control"> 
        </div> 
       </div> 
      </div> 
      <div class="form-group row datarow" style="display:none"> 
       <label class="col-sm-3 col-form-label">Bar7 data values</label> 
       <div class="input-group col-sm-9"> 
        <input type="text" name="data[]" placeholder="300 500 100 200 ..." class="form-control"> 
        <div class="input-group-append"> 
         <input type="text" name="desc[]" placeholder="Bar7" class="form-control"> 
         <input type="color" name="color[]" value="#CCCC00" class="form-control"> 
        </div> 
       </div> 
      </div> 
      <hr> 
      <div class="form-group row"> 
       <label for="legendpos" class="col-sm-3 col-form-label">Legend position</label> 
       <div class="col-sm-9"> 
        <select id="legendpos" name="legendpos" onchange="OnDraw()" class="form-control"> <option value="right" selected>Right</option> <option value="left">Left</option> <option value="top">Top</option> <option value="bottom">Bottom</option> <option value="in">In</option> <option value="none">None</option> </select> 
       </div> 
      </div> 
      <div class="form-group row"> 
       <label for="c" class="col-sm-3 col-form-label">Horizontal bars</label> 
       <div class="input-group col-sm-9"> 
        <input type="checkbox" id="c" name="c" onclick="OnDraw()" class="form-control"> 
       </div> 
      </div> 
      <div class="form-group row"> 
       <label for="c2" class="col-sm-3 col-form-label">Stacked bars</label> 
       <div class="input-group col-sm-9"> 
        <input type="checkbox" id="c2" name="c2" onclick="OnDraw()" class="form-control"> 
       </div> 
      </div> 
      <div class="form-group"> 
       <div class="btn-group flex-wrap mb-3"> 
        <button type="button" onclick="OnDraw()" title="Draw Graph" class="btn btn-primary mr-1"><img src="../lib/icons/material/svg/create_white_24dp.svg" loading="lazy" width="24" height="24" alt=""> Draw</button> 
        <button type="button" onclick="OnZoomOut()" title="Zoom Out" class="btn btn-secondary"><img src="../lib/icons/material/svg/zoom_out_white_24dp.svg" loading="lazy" width="24" height="24" alt=""></button> 
        <button type="button" onclick="OnZoomIn()" title="Zoom In" class="btn btn-secondary"><img src="../lib/icons/material/svg/zoom_in_white_24dp.svg" loading="lazy" width="24" height="24" alt=""></button> 
        <button type="button" id="fsbtn" onclick="FullscreenReq()" title="Fullscreen" class="btn btn-secondary"><img src="../lib/icons/material/svg/fullscreen_white_24dp.svg" loading="lazy" width="24" height="24" alt=""></button> 
        <button type="button" onclick="OnChartShare()" title="Share Chart" class="btn btn-secondary"><img src="../lib/icons/material/svg/share_white_24dp.svg" loading="lazy" width="24" height="24" alt=""></button> 
        <a href="#" title="Save PNG image to Downloads folder" class="btn btn-secondary" id="download" download="bar-graph" target="_blank"><img src="../lib/icons/material/svg/save_alt_white_24dp.svg" loading="lazy" width="24" height="24" alt=""></a> 
        <button type="button" onclick="OnSaveSVG()" title="Save SVG image to Downloads folder" class="btn btn-secondary"><img src="../lib/icons/material/svg/save_alt_white_24dp.svg" loading="lazy" width="24" height="24" alt=""></button> 
        <button type="button" onclick="OnCopy()" title="Copy Graph" class="btn btn-secondary"><img src="../lib/icons/material/svg/content_copy_white_24dp.svg" loading="lazy" width="24" height="24" alt=""></button> 
        <button type="button" onclick="OnPrint()" title="Print Graph" class="btn btn-secondary"><img src="../lib/icons/material/svg/print_white_24dp.svg" loading="lazy" width="24" height="24" alt=""></button> 
        <button type="button" onclick="OnReset()" title="Reset" class="btn btn-secondary"><img src="../lib/icons/material/svg/clear_white_24dp.svg" loading="lazy" width="24" height="24" alt=""></button> 
       </div> 
      </div> 
      <div class="form-group ml-0"> 
       <div id="chart_div"></div> 
      </div> 
     </form> 
     <ol> 
      <li>Enter null when no value.</li> 
      <li>Use underline '_' for space in data labels: 'name_1' will be viewed as 'name 1'.</li> 
      <li>Use 2 underlines '__' for 1 underline in data labels: 'name__1' will be viewed as 'name_1'</li> 
      <li>You can enter more than 4 data values with a space separator.</li> 
      <li>Axis range might not work with all settings.</li> 
     </ol> 
     <div id="img_div" style="position: fixed; top: 0; right: 0; z-index: 10; border:1px solid #b9b9b9"></div> 
     <h2>How to create a bar graph</h2> 
     <ul> 
      <li>Enter the title, horizontal axis and vertical axis labels of the graph.</li> 
      <li>Enter data label names or values or range.</li> 
      <li>Set number of data series.</li> 
      <li>For each data series, enter data values with space delimiter, label and color.</li> 
      <li>Check horizontal bars or stacked bars if needed.</li> 
      <li>Press the Draw button to generate the bar graph.</li> 
      <li>Press the Ã— reset button to set default values.</li> 
     </ul> 
     <br> 
     <hr> 
     <h2>See also</h2> 
     <ul class="seealso"> 
      <li><a href="line-graph.html">Line graph maker</a></li> 
      <li><a href="pie-chart.html">Pie chart maker</a></li> 
      <li><a href="scatter-plot.html">XY Scatter plot maker</a></li> 
      <li><a href="table-chart.html">Table chart maker</a></li> 
     </ul> 
     <div id="adngin-bottom_01-0"></div> 
    </div> 
   </div> 
   <div id="rcol"> 
    <div id="adngin-right_sidebar-0"></div> 
    <h5>ONLINE TOOLS</h5> 
    <ul> 
     <li><a href="bar-graph.html">Bar graph maker</a></li> 
     <li><a href="chart-maker.html">Chart maker</a></li> 
     <li><a href="line-graph.html">Line graph maker</a></li> 
     <li><a href="notepad.html">Online Notepad</a></li> 
     <li><a href="mirror.html">Online Mirror</a></li> 
     <li><a href="password-generator.html">Password generator</a></li> 
     <li><a href="pie-chart.html">Pie chart maker</a></li> 
     <li><a href="scatter-plot.html">Scatter plot maker</a></li> 
     <li><a href="screenshot.html">Online screenshot</a></li> 
     <li><a href="table-chart.html">Table chart maker</a></li> 
    </ul> 
    <h5>CONTACT</h5> 
    <ul> 
     <li><a href="mailto:?subject=Calculators &amp; Tools%20website&amp;body=Please%20checkout%20this%20site:%20https://rapid-tables.com">Recommend Site</a></li> 
     <li><a href="#feedback">Send Feedback</a></li> 
     <li><a href="../about/about.html">About</a></li> 
    </ul> 
   </div> 
  </div> 
  <div id="footer"> 
   <a href="../index-2.html">Home</a> | 
   <a href="../web/index.html">Web</a> | 
   <a href="../math/index.html">Math</a> | 
   <a href="../electric/index.html">Electricity</a> | 
   <a href="../calc/index.html">Calculators</a> | 
   <a href="../convert/index.html">Converters</a> | 
   <a href="index.html">Tools</a> 
   <p>Â© <a href="../index.html">Calculators &amp; Tools</a> | <a href="../about/about.html" rel="nofollow">About</a> | <a href="../about/terms.html" rel="nofollow">Terms of Use</a> | <a href="../about/privacy.html" rel="nofollow">Privacy Policy</a> | <a href="../about/cookies.html" rel="nofollow">Manage Cookies</a> </p> 
  </div> 
  <div id="adngin-adhesive-0"></div> 
  <script src="/assets/charts/loader.js"></script> 
  <script src="../lib/utils/utils.js"></script> 
  <script>
   "use strict"
   var title=document.getElementById("title");
   var hlabel=document.getElementById("hlabel");
   var vlabel=document.getElementById("vlabel");
   var download=document.getElementById("download");
   var hminElem=document.getElementById("hmin");
   var hmaxElem=document.getElementById("hmax");
   var hformatElem=document.getElementById("hformat");
   var hscale=document.getElementById("hscale");
   var vminElem=document.getElementById("vmin");
   var vmaxElem=document.getElementById("vmax");
   var vformatElem=document.getElementById("vformat");
   var vscale=document.getElementById("vscale");
   var chartdiv = document.getElementById('chart_div');
   var imgdata;
   var x,y,xsize,ysize,fullscreen=false;;
   
   window.addEventListener('beforeunload', function(event) {
      localSave();
   });
   window.addEventListener("DOMContentLoaded",function() {
      document.getElementById("gen").onkeypress = function(e) { if( e.keyCode==13 ) OnDraw(); };
      google.charts.load("visualization", "1", {packages:["corechart"]});
      setGraphSize();          
      try {
         localLoad();
      }
      catch(error) {
         console.error(error);
      }
      //google.charts.setOnLoadCallback(drawChart);
      setTimeout(function() { google.charts.setOnLoadCallback(drawChart); }, 1000);
   });
   document.addEventListener('fullscreenchange', (event) => {
      OnFullscreen();
   });
   
   function localLoad()
   {
      if (typeof Storage == 'undefined') return;
      var obj = localStorage.getItem('bar-graph');
      if( obj==null || obj=='' ) return;
      var v=JSON.parse(obj);
      const type=document.getElementById("type");
      const xdesc=document.getElementById("xdesc");
      const xdata=document.getElementById("xdata");
      const xrange=document.getElementById("xrange");
      const num=document.getElementById("num");
      const data = document.gen['data[]'];
      const desc = document.gen['desc[]'];
      const color = document.gen['color[]'];
      const c=document.getElementById("c");
      const c2=document.getElementById("c2");
      title.value = v.title;
      //title.value = xxx; //test undefined
      hlabel.value = v.hlabel;
      vlabel.value = v.vlabel;
      if(typeof v.hmin !== 'undefined') {
         hminElem.value = v.hmin;
         hmaxElem.value = v.hmax;
         hscale.selectedIndex = v.hscale;
         vminElem.value = v.vmin;
         vmaxElem.value = v.vmax;
         vscale.selectedIndex = v.vscale;
      }
      type.selectedIndex = v.type;
      xdesc.value = v.xdesc;
      xdata.value = v.xdata;
      xrange.value = v.xrange;
      num.selectedIndex = v.num;
      for(var i=0; i<7; i++) {
         if( v.line[i]!=undefined ) {
            data[i].value = v.line[i].data;
            desc[i].value = v.line[i].desc;
            color[i].value = v.line[i].color;
         }
      }
      c.checked=v.c;
      c2.checked=v.c2;
      OnLineNumChange(false);
      OnTypeChange(false);
   }
   function localSave()
   {
      if (typeof Storage == 'undefined') return;
      const type=document.getElementById("type");
      const xdesc=document.getElementById("xdesc");
      const xdata=document.getElementById("xdata");
      const xrange=document.getElementById("xrange");
      const num=document.getElementById("num");
      const data = document.gen['data[]'];
      const desc = document.gen['desc[]'];
      const color = document.gen['color[]'];
      const legendpos=document.getElementById('legendpos');
      const c=document.getElementById("c");
      const c2=document.getElementById("c2");
      var obj={
         title: title.value,
         hlabel: hlabel.value,
         hmin: hminElem.value,
         hmax: hmaxElem.value,
         hscale: hscale.selectedIndex,
         vlabel: vlabel.value,
         vmin: vminElem.value,
         vmax: vmaxElem.value,
         vscale: vscale.selectedIndex,
         type: type.selectedIndex,
         xdesc: xdesc.value,
         xdata: xdata.value,
         xrange: xrange.value,
         num: num.selectedIndex,
         c: c.checked,
         c2: c2.checked,
         line:[{data:data[0].value, desc:desc[0].value, color:color[0].value},
            {data:data[1].value, desc:desc[1].value, color:color[1].value},
            {data:data[2].value, desc:desc[2].value, color:color[2].value},
            {data:data[3].value, desc:desc[3].value, color:color[3].value},
            {data:data[4].value, desc:desc[4].value, color:color[4].value},
            {data:data[5].value, desc:desc[5].value, color:color[5].value},
            {data:data[6].value, desc:desc[6].value, color:color[6].value}]
      };
      localStorage.setItem('bar-graph', JSON.stringify(obj));
   }
   function setGraphSize()
   {
      x=window.screen.width-30;
      if( !fullscreen && x>600 ) x=600;
      y=x/2+90;
   }
   function OnDraw()
   {
      drawChart();
   }
   async function OnChartShare()
   {
      var titleval=title.value;
      if( titleval=="" ) titleval="mychart";
      var svg = chartdiv.getElementsByTagName('svg')[0].outerHTML;
      svg = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>"+svg;
      svg = svg.replace("<svg", "<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink= \"http://www.w3.org/1999/xlink\"");
      const svgblob = new Blob([svg], {type: 'image/svg+xml'});
      var svgfile=new File([svgblob], titleval+".svg", {type: "image/svg+xml"});
      const pngblob = await fetch(imgdata).then(r => r.blob());
      var pngfile=new File([pngblob], titleval+".png", {type: "image/png"});
      const shareData = {
            title: titleval,
            url: window.location.href,
            text: "Bar graph: "+titleval,
            files: [pngfile,svgfile]
      }
      if( navigator.canShare && navigator.canShare(shareData) ) {
         navigator.share(shareData)
         .then(() => console.log('Share was successful.'))
         .catch((error) => console.log('Sharing failed', error));
      } else {
         console.log(`Your system doesn't support sharing files.`);
      }
   }
   function OnSaveSVG()
   {
      var e = document.getElementById('chart_div');
      var svg = e.getElementsByTagName('svg')[0].outerHTML;
      svg = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>"+svg;
      svg = svg.replace("<svg", "<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink= \"http://www.w3.org/1999/xlink\"");
      var a = document.createElement("a");
      var file = new Blob([svg], {type: 'image/svg+xml'});
      a.href = URL.createObjectURL(file);
      a.download = "bar-graph.svg";
      a.click();
   }
   function OnCopy()
   {
      fetch(imgdata)
      .then(res => res.blob())
      .then(blob =>
         navigator.clipboard.write([
            new ClipboardItem({'image/png': blob})
         ])
      );
   }
   function OnPrint()
   {
      var w = window.open('about:blank');
      var image = new Image();
      image.src = imgdata;
      w.document.write(image.outerHTML);
      setTimeout(function () {
         w.document.close();
         w.focus();
         w.print();
         w.close();
      }, 500);
   }
   function OnReset()
   {
      setGraphSize();
      document.gen.reset();
      OnLineNumChange(0);
      drawChart();
   }
   function OnZoomOut()
   {
      x*=0.9;
      y*=0.9;
      drawChart();
   }
   function OnZoomIn()
   {
      x/=0.9;
      y/=0.9;
      drawChart();
   }
   function FullscreenReq()
   {
      if(chartdiv.requestFullscreen)
         chartdiv.requestFullscreen();
      else if(chartdiv.mozRequestFullScreen)
         chartdiv.mozRequestFullScreen();
      else if(chartdiv.webkitRequestFullscreen)
         chartdiv.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);
      else if(chartdiv.msRequestFullscreen)
         chartdiv.msRequestFullscreen();
   }
   function OnFullscreen()
   {
      if (!document.fullscreenElement) {
         fullscreen=false;
         chartdiv.style.setProperty("width", "100%");
         chartdiv.style.setProperty("height", "100%");
         x=xsize;
         y=ysize;
      }
      else {
         fullscreen=true;
         chartdiv.style.setProperty("width", window.innerWidth+"px");
         chartdiv.style.setProperty("height", window.innerHeight+"px");
         xsize=x;
         ysize=y;
         setGraphSize();
      }
      drawChart();
   }
   function OnTypeChange(doDraw)
   {
      var xrow0 = document.getElementById("xrow0");;
      var xrow1 = document.getElementById("xrow1");;
      var xrow2 = document.getElementById("xrow2");;
      var type = document.gen.type.selectedIndex;
      if( type==0 )
      {
         xrow0.style.display = '';
         xrow1.style.display = 'none';
         xrow2.style.display = 'none';
         }
         else if( type==1 )
      {
         xrow0.style.display = 'none';
         xrow1.style.display = '';
         xrow2.style.display = 'none';
         }
         else // type==2
      {
         xrow0.style.display = 'none';
         xrow1.style.display = 'none';
         xrow2.style.display = '';
      }
         
      if( doDraw )     
         drawChart();
   }
   function OnLineNumChange(doDraw)
   {
      var row = document.getElementsByClassName('datarow');
      var i = document.gen.num.selectedIndex;
      var k;
      if( i>0 )
         for(k=1; k<i+1; k++)
            row[k].style.display = '';
      if( i<5 )
      for(k=i+1; k<7; k++)
         row[k].style.display = 'none';
      
      if( doDraw )     
         drawChart();
   }
   function OnColorChange(color, i)
   {
   }
   function drawChart() 
   {
      var s,desc,i,k,d,ld,num,data;
      var txt = document.gen.title.value;
      if( txt=='' ) txt="Graph Title";
      
      var type = document.gen.type.selectedIndex;
      if( type==0 ) {
         s = document.gen.xdesc.value;
         if( s=='' ) s="name_1 name_2 name_3 name_4";
         //desc = s.split(' ');
         desc=s.match(/[^ ]+/g);
         for(var i=0; i<desc.length; i++)
         {
            desc[i] = desc[i].replace(/_+/g, function(m) {
               return m.length === 1 ? ' ' : m;
            });
            desc[i] = desc[i].replace(/__/g, '_');
         }
      }
      else if( type==1 ) {
         s = document.gen.xdata.value;
         if( s=='' ) s="1 2 3 4";
         //desc = s.split(' ');
         desc=s.match(/[^ ]+/g);
         }
      else { // type==2
         s = document.gen.xrange.value;
         if( s=='' ) s="1 4";
         //var s2 = s.split(' ');
         var s2=s.match(/[^ ]+/g);
         var i1 = parseFloat(s2[0]);
         var i2 = parseFloat(s2[1]);
         data = document.gen['data[]'];
         s = data[0].value;
         if( s=='' ) s="300 500 100 200";
         //s = s.split(' ');
         s=s.match(/[^ ]+/g);
         num = s.length;
         var di = (i2-i1)/(num-1);
         desc=[];
         for(i=i1,k=0; k<num; i+=di,k++)
            desc[k] = i;
      }
      
      num = document.gen.num.selectedIndex+1;
      data = document.gen['data[]'];
      d = new Array(num);
      for(k=0; k<num; k++)
      {
         s = data[k].value.replace(/,/g, '');
         if( s=='' ) s="300 500 100 200";
         //s = s.split(' ');
         s=s.match(/[^ ]+/g);
         d[k] = new Array(s.length);
         for(i=0; i<s.length; i++) {
            d[k][i] = s[i];		    		
         }
      }
      
      var c = document.gen.c.checked;
      var isStacked = document.gen.c2.checked;
   
      var arr=new Array();
      var ldesc = document.gen['desc[]'];
      arr[0] = new Array(num+1);
      arr[0][0] = 'Task';
      for(var k=0; k<num; k++)
      {
         ld = ldesc[k].value;
         if( ld=='' )
            arr[0][k+1] = 'Bar'+(k+1);
         else
            arr[0][k+1] = ld;
      }
      //arr[0][num+1] = { role: 'style' };
         
      for(var i=0; i<s.length; i++)
      {
         arr[i+1] = new Array(num+1);
         if( type==0 )
               arr[i+1][0] = desc[i];
         else
               arr[i+1][0] = parseFloat(desc[i]);
         for(k=0; k<num; k++) {
            arr[i+1][k+1] = parseFloat(d[k][i]);
         }
      }

      var data2 = google.visualization.arrayToDataTable(arr);
      
      var hLabel = hlabel.value;
      if( hLabel=='' ) hLabel='hLabel';
      var hmin=hminElem.value;
      var hmax=hmaxElem.value;
      if( hmin=="" ) hmin=null;
      if( hmax=="" ) hmax=null;
      var vLabel = vlabel.value;
      var vmin=vminElem.value;
      var vmax=vmaxElem.value;
      if( vmin=="" ) vmin=null;
      if( vmax=="" ) vmax=null;
      if( vLabel=='' ) vLabel='vLabel';
      
      var color = document.gen['color[]'];
      var optcolors=[];
      for(var k=0; k<num; k++)
      {
         optcolors[k] = color[k].value;
      }
      var options = {
         title: txt,
         hAxis: {title: hLabel},
         vAxis: {title: vLabel},
         width: x,
         height: y,
         colors: optcolors,
         isStacked: isStacked,
         animation: {startup: true, duration:1000, easing:"out"},
         legend: { position: legendpos.value }
      };
      var scaleType=[null,'log','mirrorLog'];
      var scaleFormat=['decimal','scientific','currency','percent','short','long'];
      options.hAxis.gridlines = {color: '#CCC', count: 5};
      options.hAxis.minValue = hmin;
      options.hAxis.maxValue = hmax;
      options.hAxis.format = scaleFormat[hformatElem.selectedIndex];
      options.hAxis.scaleType = scaleType[hscale.selectedIndex];
      options.vAxis.gridlines = {color: '#CCC', count: 5};
      options.vAxis.minValue = vmin;
      options.vAxis.maxValue = vmax;
      options.vAxis.format = scaleFormat[vformatElem.selectedIndex];
      options.vAxis.scaleType = scaleType[vscale.selectedIndex];
      var chart;
      if( c==false )
         chart = new google.visualization.ColumnChart(chartdiv);
      else
         chart = new google.visualization.BarChart(chartdiv);

         google.visualization.events.addListener(chart, 'ready', function () {
            var data=chart.getImageURI();
            download.href=data;
            imgdata=data;
         });
      chart.draw(data2, options);
   }
</script>  
 </body>
</html>